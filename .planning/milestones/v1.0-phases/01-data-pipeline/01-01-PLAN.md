---
phase: 01-data-pipeline
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/ftc.ts
autonomous: true
requirements:
  - PIPE-09

must_haves:
  truths:
    - "All new data shapes have TypeScript types that compile without errors"
    - "StatutoryTopic, PracticeArea, RemedyType, and IndustrySector are exported union types"
    - "ClassifiedProvision interface extends existing provision shape with new tag arrays"
    - "ProvisionRecord interface defines the denormalized shape for topic-sharded output files"
    - "EnhancedFTCCaseSummary interface extends FTCCaseSummary with classification fields"
  artifacts:
    - path: "src/types/ftc.ts"
      provides: "All TypeScript interfaces for classified data shapes"
      contains: "StatutoryTopic"
    - path: "src/types/ftc.ts"
      provides: "Denormalized provision record type for sharded files"
      contains: "ProvisionRecord"
    - path: "src/types/ftc.ts"
      provides: "Enhanced case summary type"
      contains: "EnhancedFTCCaseSummary"
  key_links:
    - from: "src/types/ftc.ts"
      to: "scripts/classify-provisions.ts"
      via: "exported type imports"
      pattern: "StatutoryTopic|PracticeArea|RemedyType|IndustrySector"
    - from: "src/types/ftc.ts"
      to: "scripts/build-provisions.ts"
      via: "exported interface imports"
      pattern: "ProvisionRecord|ProvisionShardFile|EnhancedFTCCaseSummary"
---

<objective>
Define TypeScript interfaces for all new data shapes introduced by the classification pipeline before any pipeline code is written.

Purpose: Every downstream script (classify-provisions.ts, build-provisions.ts, enhanced build-ftc-data.ts) imports from this single source of truth. Writing interfaces first forces the data contract to be explicit before implementation begins.

Output: Extended src/types/ftc.ts with all classification types — union types for taxonomies, classified provision interfaces, denormalized ProvisionRecord for sharded output, enhanced case summary, and topic shard file structure.
</objective>

<execution_context>
@C:/Users/rafst/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/rafst/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/types/ftc.ts
@.planning/phases/01-data-pipeline/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add classification taxonomy union types to src/types/ftc.ts</name>
  <files>src/types/ftc.ts</files>
  <action>
    Append the following to src/types/ftc.ts (do NOT replace existing content — add after the last existing export):

    1. StatutoryTopic union type with values: "COPPA" | "FCRA" | "GLBA" | "Health Breach Notification" | "CAN-SPAM" | "TCPA" | "TSR" | "Section 5 Only"

    2. PracticeArea union type with values: "Privacy" | "Data Security" | "Deceptive Design / Dark Patterns" | "AI / Automated Decision-Making" | "Surveillance" | "Financial Practices" | "Telemarketing" | "Other"

    3. RemedyType union type with values: "Monetary Penalty" | "Data Deletion" | "Comprehensive Security Program" | "Third-Party Assessment" | "Algorithmic Destruction" | "Biometric Ban" | "Compliance Monitoring" | "Recordkeeping" | "Prohibition" | "Other"

    4. IndustrySector union type with values: "Technology" | "Healthcare" | "Financial Services" | "Retail" | "Telecom" | "Education" | "Social Media" | "Other"

    All four types must be exported. Add a comment block above them: "// Phase 1: Data Pipeline — Classification taxonomy types"
  </action>
  <verify>Run: npx tsc --noEmit from project root. Zero TypeScript errors expected. Also grep src/types/ftc.ts for "StatutoryTopic" and "RemedyType" to confirm they appear.</verify>
  <done>src/types/ftc.ts exports StatutoryTopic, PracticeArea, RemedyType, and IndustrySector as union types. npx tsc --noEmit passes with zero errors.</done>
</task>

<task type="auto">
  <name>Task 2: Add classification interfaces for source file enrichment and pipeline output</name>
  <files>src/types/ftc.ts</files>
  <action>
    Continue appending to src/types/ftc.ts (after Task 1 additions). Add the following five interfaces, each exported:

    1. **ClassifiedProvision** — provision shape written into source files after classification. Fields: all existing provision fields plus statutory_topics: StatutoryTopic[], practice_areas: PracticeArea[], remedy_types: RemedyType[]. Include provision_number: string, title: string, category: string, summary: string. Add comment: "// Written into public/data/ftc-files/ source JSON by classify-provisions.ts"

    2. **ClassifiedCaseInfo** — case_info shape after classification. Fields: id, docket_number, company_name, date_issued, year (number), administration, legal_authority, ftc_url (optional string), source_filename, plus statutory_topics: StatutoryTopic[], practice_areas: PracticeArea[], industry_sectors: IndustrySector[]. Add comment: "// Extends case_info in source files with classification tags"

    3. **ProvisionRecord** — denormalized provision record for topic-sharded output files. Fields: provision_number, title, category, summary, all three tag arrays (statutory_topics, practice_areas, remedy_types), plus denormalized case context: case_id: string, company_name: string, date_issued: string, year: number, administration: string, legal_authority: string, ftc_url?: string, docket_number: string. Add comment: "// Denormalized provision in topic-sharded output files under public/data/provisions/"

    4. **ProvisionShardFile** — structure of each topic shard file. Fields: topic: string, generated_at: string, total_provisions: number, provisions: ProvisionRecord[]. Add comment: "// public/data/provisions/[topic]-provisions.json"

    5. **EnhancedFTCCaseSummary** — extends FTCCaseSummary (existing interface, NOT redefine it — use intersection or extend). Add fields: statutory_topics: StatutoryTopic[], practice_areas: PracticeArea[], industry_sectors: IndustrySector[], remedy_types: RemedyType[], provision_counts_by_topic: Record&lt;string, number&gt;. Keep existing categories: string[] field for backward compatibility. Add comment: "// Enhanced case summary in ftc-cases.json — keeps categories for backward compat"

    Note on tsx scripts: scripts/build-ftc-data.ts currently inlines its own types rather than importing from src/types/ftc.ts (there's a comment about path alias issues). The new scripts/classify-provisions.ts and scripts/build-provisions.ts should use explicit relative paths to import: `import type { ... } from '../src/types/ftc.js'` — note the .js extension required by tsx with ESM.
  </action>
  <verify>Run: npx tsc --noEmit from project root. Zero TypeScript errors. Grep src/types/ftc.ts for "ProvisionRecord", "ProvisionShardFile", "EnhancedFTCCaseSummary", "ClassifiedProvision", "ClassifiedCaseInfo" — all five should appear.</verify>
  <done>src/types/ftc.ts exports all five interfaces. npx tsc --noEmit passes. All five interface names confirmed present in the file.</done>
</task>

</tasks>

<verification>
Run `npx tsc --noEmit` from project root — must pass with zero errors.
Run `grep -n "export" src/types/ftc.ts | grep -E "StatutoryTopic|PracticeArea|RemedyType|IndustrySector|ClassifiedProvision|ClassifiedCaseInfo|ProvisionRecord|ProvisionShardFile|EnhancedFTCCaseSummary"` — all nine names must appear.
</verification>

<success_criteria>
src/types/ftc.ts exports: StatutoryTopic, PracticeArea, RemedyType, IndustrySector (union types) and ClassifiedProvision, ClassifiedCaseInfo, ProvisionRecord, ProvisionShardFile, EnhancedFTCCaseSummary (interfaces). TypeScript compiles without errors. Existing FTCCaseSummary, FTCDataPayload, GroupStats, GroupingMode are untouched.
</success_criteria>

<output>
After completion, create `.planning/phases/01-data-pipeline/01-01-SUMMARY.md`
</output>
